(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-chatRoom-chatRoom"],{"0c7d":function(t,e,i){"use strict";i.r(e);var n=i("4758"),o=i.n(n);for(var a in n)"default"!==a&&function(t){i.d(e,t,(function(){return n[t]}))}(a);e["default"]=o.a},"0e89":function(t,e,i){"use strict";i.r(e);var n=i("69ca"),o=i("0c7d");for(var a in o)"default"!==a&&function(t){i.d(e,t,(function(){return o[t]}))}(a);i("75b3");var s,c=i("f0c5"),l=Object(c["a"])(o["default"],n["b"],n["c"],!1,null,"ce0a603c",null,!1,n["a"],s);e["default"]=l.exports},"411f":function(t,e,i){var n=i("9825");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var o=i("4f06").default;o("35fc8d7e",n,!0,{sourceMap:!1,shadowMode:!1})},4758:function(t,e,i){"use strict";i("a434"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={data:function(){return{room:!0,bb:!1,bg:"none",userIndex:null,myInfo:{head:"",name:"",selecthead:"",id:""},anotherStatus:"",anotherInfo:{},member:0,inputValue:"",megList:[],img:[{i:"1"},{i:"2"},{i:"3"},{i:"4"},{i:"5"},{i:"6"},{i:"7"},{i:"8"},{i:"9"},{i:"10"},{i:"11"},{i:"12"}],users:[{head:"",id:"HKDT1j_3YJNyhlmyAAAC",name:"白白",selecthead:"3"}],otoChat:[]}},onLoad:function(t){console.log(t.myhead),t.myhead?this.myInfo.head=t.myhead:this.myInfo.selecthead=t.selecthead,this.myInfo.name=t.myname,console.log(this.socket),this.join(),this.myself(),this.welcome(),this.getMsg(),this.getOneMsg(),this.getInputing(),this.quit()},onUnload:function(){console.log("页面关闭")},methods:{modify:function(){this.bb=!this.bb,this.bb?this.bg="block":this.bg="none"},exit:function(){console.log("断开链接");var t=this;uni.showModal({title:"",content:"是否断开链接？（注销用户）",cancelColor:"#007AFF",confirmColor:"red",success:function(e){e.confirm?(console.log("用户点击确定"),uni.reLaunch({url:"../index/index",success:function(){t.socket.close()}})):e.cancel&&console.log("用户点击取消")},complete:function(t){console.log(t)}})},join:function(){console.log("加入群聊"),this.socket.emit("join",this.myInfo)},welcome:function(){var t=this;console.log("欢迎群聊"),this.socket.on("welcome",(function(e,i,n){var o={mess:"欢迎 "+e+" 加入群聊",type:"tip"};t.megList.push(o);for(var a=0;a<i.length;a++)i[a].id==t.myInfo.id&&i.splice(a,1);t.users=i,console.log("users"),console.log(i),console.log(t.megList),t.member=n}))},myself:function(){var t=this;this.socket.on("myself",(function(e,i,n){var o={mess:"欢迎 "+t.myInfo.name+" 加入群聊",type:"tip"};t.megList.push(o),t.myInfo.id=i,t.users=e,console.log(t.megList),t.member=n}))},sendAll:function(){if(this.inputValue.length>0){var t={mess:this.inputValue,img:this.myInfo.head,selectImg:this.myInfo.selecthead,time:new Date,type:"mine"},e={name:this.myInfo.name,mess:this.inputValue,img:this.myInfo.head,selectImg:this.myInfo.selecthead,time:new Date,type:"other"};this.megList.push(t),this.socket.emit("message",e),this.inputValue="",console.log(t.img)}},Inputing:function(){var t={mess:"对方正在输入中...",fid:this.myInfo.id,tid:this.anotherInfo.id};this.socket.emit("inputing",t)},getInputing:function(){var t=this;this.socket.on("getInputing",(function(e){console.log(e.mess),t.anotherStatus=e.mess;var i=t;setTimeout((function(){i.anotherStatus=""}),2e3)}))},sendOne:function(){if(this.inputValue.length>0){var t={mess:this.inputValue,time:new Date,fid:this.myInfo.id,tid:this.anotherInfo.id},e={name:this.myInfo.name,mess:this.inputValue,img:this.myInfo.head,selectImg:this.myInfo.selecthead,time:new Date,fid:this.myInfo.id,tid:this.anotherInfo.id};this.otoChat.push(t),this.socket.emit("sendOne",e),this.inputValue=""}},getMsg:function(){var t=this;this.socket.on("sendMsg",(function(e){t.megList.push(e)}))},getOneMsg:function(){var t=this;this.socket.on("receiveOne",(function(e){for(var i=0;i<t.users.length;i++)e.fid==t.users[i].id&&t.users[i].count++;t.otoChat.push(e)}))},quit:function(){var t=this;console.log("前端退出"),this.socket.on("exit",(function(e,i,n,o){console.log("前端退出2"),console.log(e),console.log(n),o==t.anotherInfo.id&&(t.anotherStatus="已离线");var a={mess:e+" 离开群聊",type:"tip"};t.megList.push(a),console.log("用户退出了");for(var s=0;s<i.length;s++)i[s].id==t.myInfo.id&&i.splice(s,1);t.users=i,console.log(t.users),t.member=n}))},toChat:function(t,e){this.userIndex=e,this.users[e].count=0,this.anotherInfo=t,this.room=!this.room},back:function(){""==this.anotherStatus?this.users[this.userIndex].count=0:this.anotherStatus="",this.room=!this.room}},filters:{timeDetia:function(t){var e,i=new Date(t),n=new Date,o=(i.getTime(),i.getHours()),a=i.getMinutes(),s=i.getFullYear(),c=i.getMonth(),l=i.getDate(),r=(n.getTime(),n.getHours(),n.getMinutes(),n.getFullYear()),u=n.getMonth(),d=n.getDate();return l==d&&c==u&&s==r?(o<10&&(o="0"+o),a<10&&(a="0"+a),e=o+":"+a,e):l+1==d&&c==u&&s==r?(o<10&&(o="0"+o),a<10&&(a="0"+a),e="昨天"+o+":"+a,e):(c<10&&(c="0"+c),l<10&&(l="0"+l),o<10&&(o="0"+o),a<10&&(a="0"+a),e=s+"年"+c+"月"+l+"日 "+o+":"+a,e)}}};e.default=n},"69ca":function(t,e,i){"use strict";var n;i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return n}));var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.room?i("v-uni-view",{staticClass:"content"},[i("v-uni-view",{staticClass:"nav"},[i("v-uni-view",{staticClass:"left",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.exit.apply(void 0,arguments)}}},[t._v("‹")]),i("v-uni-view",{staticClass:"center"},[t._v("喵呜聊天室")]),i("v-uni-view",{staticClass:"right"},[t._v("在线 "+t._s(t.member)+"人")])],1),i("v-uni-view",{staticClass:"open_member"},[i("v-uni-view",{staticStyle:{"text-align":"center",width:"100%",height:"60upx","line-height":"60upx"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.modify.apply(void 0,arguments)}}},[t._v("当前在线成员﹀")])],1),i("v-uni-view",{staticClass:"zhanwei1"}),i("v-uni-view",{staticClass:"chat_content"},t._l(t.megList,(function(e){return 0!=t.megList.length?i("v-uni-view",{key:e.id},["other"==e.type?i("v-uni-view",{staticClass:"other-people"},[e.img?i("v-uni-image",{attrs:{src:e.img,mode:"aspectFill"}}):i("v-uni-image",{attrs:{src:"../../static/images/pic"+e.selectImg+".jpg",mode:"aspectFill"}}),i("v-uni-view",{staticStyle:{"margin-left":"20upx"}},[i("v-uni-view",{staticStyle:{"margin-bottom":"10upx","font-size":"24upx",color:"#999"}},[t._v(t._s(e.name))]),i("v-uni-view",{staticStyle:{display:"flex","align-items":"center"}},[i("v-uni-view",{staticClass:"meg"},[t._v(t._s(e.mess))]),i("v-uni-text",{staticStyle:{"font-size":"24upx",color:"#999","margin-left":"10upx"}},[t._v(t._s(t._f("timeDetia")(e.time)))])],1)],1)],1):t._e(),"mine"==e.type?i("v-uni-view",{staticClass:"my-message"},[i("v-uni-view",{staticStyle:{"margin-right":"20upx"}},[i("v-uni-view",{staticStyle:{"text-align":"right","font-size":"24upx","margin-bottom":"10upx",color:"#999"}},[t._v(t._s(t.myInfo.name))]),i("v-uni-view",{staticStyle:{display:"flex","align-items":"center"}},[i("v-uni-text",{staticStyle:{"font-size":"24upx",color:"#999","margin-right":"10upx"}},[t._v(t._s(t._f("timeDetia")(e.time)))]),i("v-uni-view",{staticClass:"matter"},[t._v(t._s(e.mess))])],1)],1),e.img?i("v-uni-image",{attrs:{src:e.img,mode:"aspectFill"}}):i("v-uni-image",{attrs:{src:"../../static/images/pic"+e.selectImg+".jpg",mode:"aspectFill"}})],1):t._e(),"tip"==e.type?i("v-uni-view",{staticClass:"tips"},[i("v-uni-view",{},[t._v(t._s(e.mess))])],1):t._e()],1):t._e()})),1),i("v-uni-view",{staticClass:"bottom_input"},[i("v-uni-textarea",{attrs:{type:"text",placeholder:"输入消息~","adjust-position":!0,"auto-blur":"true","auto-height":"true",maxlength:"300","cursor-spacing":"20"},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}),i("v-uni-text",{class:["send_btn",t.inputValue?"active_btn":""],on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.sendAll.apply(void 0,arguments)}}},[t._v("发送")])],1),i("v-uni-view",{staticClass:"modify",style:{display:t.bg}},[i("v-uni-view",{staticClass:"modify-main"},[t.users.length>0?t._l(t.users,(function(e,n){return i("v-uni-view",{key:n,staticClass:"us",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toChat(e,n)}}},[i("v-uni-view",{staticClass:"us-img"},[e.head?i("v-uni-image",{attrs:{src:e.head,mode:"aspectFill"}}):t._e(),e.selecthead?i("v-uni-image",{attrs:{src:"../../static/images/pic"+e.selecthead+".jpg",mode:"aspectFill"}}):t._e(),e.count?i("v-uni-view",{staticClass:"us_count"},[t._v(t._s(e.count>=9?"9+":e.count))]):t._e()],1),i("v-uni-view",{staticClass:"us_name"},[t._v(t._s(e.name))])],1)})):t._e()],2),i("v-uni-view",{staticClass:"modify_up",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.modify.apply(void 0,arguments)}}},[t._v("︿")])],1),i("v-uni-view",{staticClass:"bg",style:{display:t.bg},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.modify.apply(void 0,arguments)}}})],1):i("v-uni-view",{staticClass:"content"},[i("v-uni-view",{staticClass:"nav"},[i("v-uni-view",{staticClass:"left",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.back.apply(void 0,arguments)}}},[t._v("‹")]),i("v-uni-view",{staticClass:"center",staticStyle:{color:"black"}},[i("v-uni-view",[""==t.anotherStatus?i("v-uni-text",[t._v(t._s(t.anotherInfo.name))]):i("v-uni-text",{staticStyle:{color:"pink","font-size":"20upx"}},[t._v(t._s(t.anotherStatus))])],1)],1)],1),i("v-uni-view",{staticClass:"zhanwei2"}),i("v-uni-view",{staticClass:"chat_content"},t._l(t.otoChat,(function(e,n){return t.otoChat.length>0?i("v-uni-view",{key:n},[e.fid==t.anotherInfo.id&&e.tid==t.myInfo.id?i("v-uni-view",{staticClass:"other-people"},[e.img?i("v-uni-image",{attrs:{src:e.img,mode:"aspectFill"}}):i("v-uni-image",{attrs:{src:"../../static/images/pic"+e.selectImg+".jpg",mode:"aspectFill"}}),i("v-uni-view",{staticStyle:{"margin-left":"20upx"}},[i("v-uni-view",{staticStyle:{"margin-bottom":"10upx","font-size":"24upx",color:"#999"}},[t._v(t._s(e.name))]),i("v-uni-view",{staticStyle:{display:"flex","align-items":"center"}},[i("v-uni-view",{staticClass:"meg"},[t._v(t._s(e.mess))]),i("v-uni-text",{staticStyle:{"font-size":"24upx",color:"#999","margin-left":"10upx"}},[t._v(t._s(t._f("timeDetia")(e.time)))])],1)],1)],1):t._e(),e.tid==t.anotherInfo.id&&e.fid==t.myInfo.id?i("v-uni-view",{staticClass:"my-message"},[i("v-uni-view",{staticStyle:{"margin-right":"20upx"}},[i("v-uni-view",{staticStyle:{"text-align":"right","font-size":"24upx","margin-bottom":"10upx",color:"#999"}},[t._v(t._s(t.myInfo.name))]),i("v-uni-view",{staticStyle:{display:"flex","align-items":"center"}},[i("v-uni-text",{staticStyle:{"font-size":"24upx",color:"#999","margin-right":"10upx"}},[t._v(t._s(t._f("timeDetia")(e.time)))]),i("v-uni-view",{staticClass:"matter"},[t._v(t._s(e.mess))])],1)],1),t.myInfo.head?i("v-uni-image",{attrs:{src:t.myInfo.head,mode:"aspectFill"}}):i("v-uni-image",{attrs:{src:"../../static/images/pic"+t.myInfo.selecthead+".jpg",mode:"aspectFill"}})],1):t._e()],1):t._e()})),1),i("v-uni-view",{staticClass:"bottom_input"},[i("v-uni-textarea",{attrs:{type:"text",placeholder:"输入消息~","adjust-position":!0,"auto-blur":"true","auto-height":"true",maxlength:"300","cursor-spacing":"20"},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.Inputing.apply(void 0,arguments)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}),i("v-uni-text",{class:["send_btn",t.inputValue?"active_btn":""],on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.sendOne.apply(void 0,arguments)}}},[t._v("发送")])],1)],1)},a=[]},"75b3":function(t,e,i){"use strict";var n=i("411f"),o=i.n(n);o.a},9825:function(t,e,i){var n=i("24fb");e=n(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.content[data-v-ce0a603c]{width:100%;min-height:100vh;position:relative;background-color:#f4f4f8;display:flex;flex-direction:column}.content .nav[data-v-ce0a603c]{background-color:#fff;display:flex;justify-content:center;align-items:center;position:fixed;z-index:999;height:%?80?%;width:100%;box-sizing:initial;padding-top:calc(0px)}.content .nav .left[data-v-ce0a603c]{left:%?20?%;font-size:%?50?%;height:%?80?%;width:%?100?%;position:absolute}.content .nav .center[data-v-ce0a603c]{font-size:%?30?%;color:pink}.content .nav .right[data-v-ce0a603c]{color:#007aff;font-size:%?24?%;right:%?20?%;position:absolute}.content .open_member[data-v-ce0a603c]{background-color:pink;width:100%;position:fixed;top:calc(%?80?% + 0px);z-index:99;font-size:%?24?%;color:#fff}.content .zhanwei1[data-v-ce0a603c]{width:100%;height:calc(%?180?% + 0px)}.content .zhanwei2[data-v-ce0a603c]{width:100%;height:calc(%?80?% + 0px)}.content .chat_content[data-v-ce0a603c]{min-height:100vh;margin-bottom:%?120?%;padding:0 %?20?% 0;width:100%}.content .chat_content .my-message[data-v-ce0a603c]{display:flex;justify-content:flex-end;margin-top:%?30?%}.content .chat_content .my-message uni-image[data-v-ce0a603c]{width:%?80?%;height:%?80?%;border-radius:50%}.content .chat_content .my-message .matter[data-v-ce0a603c]{background:pink;padding:0 %?25?%;height:%?70?%;line-height:%?70?%;font-size:%?28?%;color:#393939;border-top-left-radius:%?20?%;border-bottom-left-radius:%?20?%;border-bottom-right-radius:%?20?%}.content .chat_content .other-people[data-v-ce0a603c]{display:flex;margin-top:%?30?%}.content .chat_content .other-people uni-image[data-v-ce0a603c]{width:%?80?%;height:%?80?%;border-radius:50%}.content .chat_content .other-people .meg[data-v-ce0a603c]{padding:0 %?25?%;height:%?70?%;line-height:%?70?%;font-size:%?28?%;color:#393939;background:#fff;border-top-right-radius:%?20?%;border-bottom-left-radius:%?20?%;border-bottom-right-radius:%?20?%}.content .chat_content .tips[data-v-ce0a603c]{width:100%;font-size:%?24?%;color:#999;text-align:center;padding:%?60?% 0}.content .bottom_input[data-v-ce0a603c]{position:fixed;width:100%;padding:%?16?%;border-top:%?1?% solid #e2e2e2;bottom:0;left:0;z-index:99;display:flex;align-items:center;background-color:#fff}.content .bottom_input uni-textarea[data-v-ce0a603c]{line-height:%?40?%;padding:%?16?% %?30?%;flex:1;background-color:#f0f0f0;border-radius:%?40?%;font-size:%?26?%}.content .bottom_input .send_btn[data-v-ce0a603c]{margin-left:%?20?%;padding:%?12?% %?36?%;border-radius:%?40?%;font-size:%?26?%;background-color:pink;color:#fff}.content .bottom_input .active_btn[data-v-ce0a603c]{background-color:#ff93a6}.modify[data-v-ce0a603c]{position:fixed;left:0;top:calc(%?80?% + 0px);width:100%;z-index:1000;background-color:#fff;border-radius:0 0 %?48?% %?48?%;overflow:hidden;border-top:%?1?% solid #e2e2e2}.modify-main[data-v-ce0a603c]{padding:%?20?% %?36?% 0;flex-direction:row;display:flex;flex-wrap:wrap}.modify-main .us[data-v-ce0a603c]{width:20%;text-align:center;padding:%?20?% 0}.modify-main .us .us-img[data-v-ce0a603c]{width:%?100?%;height:%?100?%;position:relative;margin:auto}.modify-main .us .us-img uni-image[data-v-ce0a603c]{width:100%;height:100%;border-radius:50%}.modify-main .us .us_count[data-v-ce0a603c]{position:absolute;top:2px;right:-2px;border-radius:15px;color:#fff;background-color:red;height:15px;\r\n  /* width: 15px; */font-size:10px;line-height:15px;text-align:center;padding:0 4px}.modify-main .us_name[data-v-ce0a603c]{width:100%;font-size:%?24?%;text-align:center;padding-top:%?10?%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:grey}.modify_up[data-v-ce0a603c]{color:pink;font-size:%?24?%;text-align:center;width:100%;height:%?60?%}.bg[data-v-ce0a603c]{width:100%;height:100%;position:fixed;top:0;left:0;z-index:100;background-color:rgba(0,0,0,.4)}',""]),t.exports=e}}]);